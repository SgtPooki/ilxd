// Copyright (c) 2022 The illium developers
// Use of this source code is governed by an MIT
// license that can be found in the LICENSE file.

package blockchain

import (
	"encoding/hex"
	"github.com/project-illium/ilxd/types/transactions"
	"github.com/project-illium/ilxd/zk"
	"github.com/stretchr/testify/assert"
	"google.golang.org/protobuf/proto"
	"os"
	"testing"
)

func TestMain(m *testing.M) {
	zk.LoadZKPublicParameters()
	os.Exit(m.Run())
}

func TestProofValidator(t *testing.T) {
	proofCache := NewProofCache(10)
	proofValidator := NewProofValidator(proofCache, &zk.LurkVerifier{})

	stdTxBytes, err := hex.DecodeString("0abd020a202728d1d64446788b3b084e40cf0421aa9e6fb6c936b7fa03aebc07c23e6af1e6129802d5962854e7f7733b95f3c730aa8186812fc37b7c2dc7907ea23dbe5a61917968920bd8246a1c3466658fb55111dbd7a495f55921b2f3de676227331a5a6de596e4be880dc7316cb4708687cb172e9b64007fa02d83eaf868b137b350e73a5f1da4712a903fe4138d7d88c6bbef67f76499cebf1382bf7817614a7fbdd3676fb8a4d1747aaaf7d7300278f55de11ee5f4ef8d269b974c6b13af5d208a46a6867a6c82174894f19a2cc607c9e9f493758dae7379eaa091787ce2a7a046ca4b7e65f2ad2d7f9bdcf040728ad13d963501b9261d190553009022113897ec6157161bc3a8f866adea391f41f0f26d4421725d2d1fec60052478f99ff20b7ef875e7b11b890c58e51b0927c3f31a75a2157fbb69f1f0958ca9946f0abd020a203d192313eb779aff7f0b7d7d789f755bf34925b63b372f085e053ecf6028afd9129802e1b08b4537e8c7f5045b407033eba31c66331421702b2e15ae728ebdc8c75e7a3a53fd6fce63a01cddcfacc19e2f17f358b61055d9d58bc7862348d0a53c7493ace31aa5120bb8d28a87d0967c957c9ff77385d4c1e03ce2621a6aa786f5924abb28420ea4718ce1bad39b54ee4e7e76cec00808aef2e2ba86d53edd8a5651e96fbf15df2cf70cbe3c761d4c11464d989ac47d3e55054068a673121e05ec8923f614fa49d5906835180acdfc366559a73186b42095a04d87f1af436dfb453c56e06144930eaddf000b22c497216b68790cd8c6a3f7988bcffb7444fe17b93144325419f4f65e609d3173455ccf43211a34c1ef7d1f613875b528b9366dbdfd7c3e945f1e4932bcf6a8138655f495d2e8d2ad433981e2187c122036c13f5ca68b079fb9b3cfec8474fe0bdfbb693a2f6b22694cabdbd680c05d9f1220345899ebeeaeecfeefbc31ab2004adfc93a6e88d5c2e9a8b8765e6f9fc8282fd1a2003cc7299f1272da3b6a672c476eae214ee2816ba24e3ac5f9fe410298a2fd4bf220b088092b8c398feffffff0128a08d0632ee5922c939e46c88c468e4fa6f098889c1c611d039dc8866a723e0e1a0b50fe0a425789ced9b5370a66fb7e663dbb63ab66dab63db56c749c7b66ddb363be8a43bb66d3b3355f3bd999a3d35f5df07fb9baaa99aebe43979eb77adf560dd58f70b0c04040409f43fd4818b8fb9fcec69fdd0cc995f9a6bc542b53e75b82d35b0e17e82674283f51705daf3b0abfbeeaf6ad8994a7bd59b4e96437bf97d110cd57e1fc805dadf5b0858907f716ef562a671e622c88923e3b8660678593133e6aa3d8da3afa6a4c0c055acc9092ddc6defd19846af49d7486019ddd895d5d6a23786632790c759c8dbae0ffda0efca5b1d48df674341aa4b0944ac9a995d80fe6b0502f4ff86fe7f9cffabf60366a5a083fcc44de0a7253df4af11d5a549605e93e0ed4268cc4b9b94558932d617610a5fdd5a6c42dca803b1ccbf2187bbdbffb841456c65b50192e37bfb8ab33c796affd8e31a083ef378b2ce510abdca1833cdfa34f95bb0706f9a3b082a3801262c6ebd86fca9394be061b2ad8259ece89876d4d5fe8bdb6ec581d57309e8ce6caebdca8f571ca98d3c18c5361bbbff18278f69bc2a1fb454dd6707d7f67ceef48a486f1c019f4680113254514ef543295937422a13fa5ecb86272dc8ee872301f3d1163a82239afc31b7133c5683f11601204e3ff075a9c0d9d06d0cbfd087dcbf0d1c2ac222e77124c48388d9706d127836f807902517854e350e850bbdbf66c434e1b41ec7d27d2288fa5025d078be6709523ab18dce9fb4e36f76edfbee7a73cc428301fdd7eaffd67347fed715f43ff9fbd81577759a557396a95f903b9e493ef6bfaf06ae9d8ae76263f156471992d531a90e23e33b42e4b90eacaba3f4f98f2b6399673d06ac5358b36f349fe1dddf79013ed7d5a9bb5dce4e69d511d07e8f020c423508b05b6e32f1e372c9471f14de6690ee8ff65435dfe15ee98d81626a0b6dd42eff6a661d47e49042388806b2f4a213945832626f9bcebff3c188dbc1ed8f34c8c4c723986cc71a8ce1ec4649681403037c32952e9a371036950c1ac68e3391bccc94cac4846d1ce9a4e89937a54a4faf396098b6863365868ce92f52c2559f37ed9f2c3d6032ecd02e4fcfd4efe3a7082810a73d356395ed6325c18054f0b8ef60d1b9a91a1350a92a45a5cebc316344f1003ede96ab1234a862580956ae90d904661c7232b4de7cfbcb73123d1d554dbb748cec41817586c5840ebeabf352bcfb04de8fb043c6a3cebe6feefc952497dc53fc7a094f9af23687a9d355e12ff176a506aefe62d8c0255a2d0186e7135415866c009faeb3b789aa3c9d3e4979c3e1741a49857154649d6913a92766915360019f2c0a8f9b1c72b6b511d17523c16c122b38d3a234acf1e6f9f04bbd91445d05d32ef0ca9c424993ac5fbf1317c5dea599dfe8256c1162d9f93cab2e5af99cee358f19013e0870fbe5a40b95506b6f6907be193069bafa063b9c42519c624a9ed8f31e1908add3b1f18d304d0a500cdef6bb03cca6d5bfa6d674a0725bccad2dd7587d6021c7df316f99f8f435d5ef9995aed7dbeb7934841a7fb64fa6a4b614a50f7282e0027c964dc7f74d7593135f0535430d36c0bf4b77d6c3832c84e3e49143c36adffa23961e2a0c21e22b71ff04aa19eb483a518a56e468c64b2ba7386576e8e8b35c656cc8d27323b322830e12574ecbfe71866f6f2759d3d3765459e1da1db51a684c09f0913e18f44f018538bd309385cd038193eb4e906091efca81069b0ee6fe14d0c5d27f80aa189e3b3946d7f52a18f1bddfa5922378dc1abb0d4dc1fff5f77c6016f1b854270246d839208b3d260535a49857ea6295d9d204ac9a1c89fb3312cf8e14e0538846ddae9433d21145c3808fc343f41b5fa59ea7bba6ed5dbd2f5eb85d271bfbb958d4d7dd0019bc536f338b79107b7f26ebf62ac786c40c9b5baeec81349d04d4649bc798677e257117a6f2815c7f1efa275f56417ceaeca25bb6a167c1221cc027bba167172912eb291d8e438bed8f5979e8b8ff985b123cf9f777d7df318dfb18684478663fae07feb23cf51156183d3968755a98d1c0c2a2531349ca45ea12b29b1cf5226fb9c1c9b4f54ae8a8193a7cfcaeaf357d1b2bcdc98b6d8a6606eef8fa7e1c0caf12263b8f20d9698278bee5b0a4fef5c8249b28eb7df3066bd47faae7847a3ff1360b481ac31393eff0e5776ca6270a0191505cd866c3542d9cc52be6265c89bdf197a59b4de975085b479c747c90ba3bbc18b5a3c6959b6601bd7683fefa7e26b7e0d3e41c3136225f1c16bf2b0eb35c040820f56ea52cb26bd53db6196dc3fe4524bae51f92e9c5c9a6e02c8ada8d70f59297796dd68560e178cd9b80f0273b600bfc8907767da96154bfd0fa3db2518a3dea396495cfb8546c8e9d1dc48e08e0d3d8a56f42f3b34064b2425da6be1ac347223ff054171523b7c649c59615b1948d576308ac6950e874f6db22ade0194305075f39b974f2c91ee6ce538bb56b3c8f732c95a4fb54d76d720197992edcc1e96e2aeda774f39c2b2141ef1414961c12c027d8ca1cc6139e80f8c4321ab84d404811a1c152d1902a19f5d1a0f227784e16aa6c3f14e839770c73521e8c4c7e2279f3b2d8d681b54d16d7cfc15a02d2a861e252670d79704adf75043398b5d3d7301bfe1ffc5d5d28b5b49835ad9459dff698bff2819d0ec9508660be41f4cbcb24690dbf024bf073c389f9cd84754ed4d2818ab32a3c5386b1d4fb87145e243a6a85ca820dd6ae44c0bbaa6a7ad4006241ca957f6e2483146b5e282e3493dce3faf80c35a8eebb6556115de4283c9ee0e778210fc0475c7b8826e3baf6e96fe7ad30ca306f8997f22e343e8d74dab87c53bc31a324f97775a9425fb55f7bd26fbb8c1c79c8b02f8ce060ecacb04858068123992fd25c39c3e122c4a993749b157cd9415e2a4c50d82a09a695a5597a22f6da0e783d34001fcd2ae9f796cf582b25115686d25adcb274e43ccc0ed13009ebfa23da9f1aad2057a9e219feebf1c0c5947243d5e7a0401fa910a58f66273b7dd894f505237548d2b8e19a8b552e39a2640ddd08441126030eba360da8387a72e8e27e04d8b7a080f9f847b20b907ff46f48b284dd42095f13462733e3b8fdf66bec1ead996f437582ec40ff6621dac57588967d2e8fdbd7bf23e28625d6fca8a800e9f271f506c6844bccc0c41c5f4ac958a29bb813eec9ec1dd596fee19dc08150b9393c91ad4e3a94877a44fe4f7c409edbef2b9540efd3172c9864207795bf489e4ce997fa398d072e6ea1e8795469fefd797e2af4e2c2a93f43b01589f868162b291bbcac3dc91e904c0db0befad6980ae0ce6c140cebf18250a7caffc0d7c6eb0f169e5533915769e75d039934c2daf94fe779445449f6c4daae0eecaabe03b646056b829768fe8616b6d5d1b419222b68cc05f46f969f3eea09fda2e624396a1cd0fbc9d575d4014e4608107c462b9009a6f3912284893b4e0cd54c5e93926de4a141bcd9c31ca565ddae21ebdd2b8e859fa1a00af73ff10179761e82b7ab3c74421a65eb2c1c40239c6ac513d8719979aacf71041bdddfd13303fd9b653bc278d81dbaae3e0f222d9672764ae37981097b336de6a74e632e791b01ceeb08631127ba90631b49c4c940dc84b636286b441bc9410ab226f9293722ce0bf14f7c947f5d01f3dfdf6e9e1e3dc092be9b67ca336c0a988d84c669d82e13cbe1971d0f7f22b5a2093486eaa92a7eb942d7515e3535145a3f0aadc366b599a5468925515d8c2fde110338b64e72f0e768023143e7b946128860f6d53549b9fc1f47737fbde73987bca109bdb1712722d556da53e2169713026ecd30036b6cc1d6206f4eb20bda90056af1019c542a7c9d45457ff21a444d3df6549b31f3508270b5b790f3bb573d614dae9ff0aea047c7930e7010a1c3766dba076cb0f939755209f1f7ecd0733ad5c6741a2c000eee15fadd5072b726d724f085a22a9656b0e5122fdae73dda307e0f4aee6626d5664f32ff494c25c3426162b65655cdb9dc6bb76a1c51606d9df165488129193080633d177dba9b73235f0056dbed293fd9a8d96d5e694092b6c36576e893ce84c131cfb2627519878377cb69002b75a14e56e60a6b9908d2eb7bff23e8d6c575081ac0c99093f75b6754e90f51ec3ab4a2d69fdba91352360f2c33f1b4f9b5ee86f21b52cf74b9f50e57388ac0017aff6400aeafb42b1edfbbada629f3900031aa15e76b5d255f46888bab94a0056ce31583beed6f72d4aa8e86f04aef7a615c51ae91e50703c2b295e72b46141b43a245092c9d35d5328ca575e72208d4581f682709a24502e0d8f54d372812ffea72616c3bf7de36473ab5418cf023b194966c80b921dae205e109e5678e7fede45dd5c75b5032a8f59ea98db389a4413c827961300ef2dac10670924b9830632349a4eae3eca6620d5c8d1f2623e92311fdb2125697dc03289a50c80a228c692b48f1ebf0b739cfdba1ecf4293f06688eb327d61f73031c7ceb98009c8387ce6e67c298bd49be4f6247bbd231d605cd7a7c11a36ba2558693f61309527b5f4160fcddfed0a07e49916e819f58deea786524a242a4f9e72af479bfe0bee2794a6a3d773767bcd8fef6fe384513d21b2f88cfcec49804da9ecd53506a6c094fa7b1cc041b08ad42fa2b790a38fc57357fff671ca7b958dcd5650faa878e120780a34bb29374d6c86585d3017be5b04d475b66d099f4e27503f4cc0016a5483b28504c30043699ce0b4e7ec2b4005df4f2e81cb9e73deb0a77a7f93645d97e394504e094a40d8013004f56355807caa5d86c3e2bb60de4a88358cc3e6ed9c6da4ea772a4e7d1dfec6aa9c4e7adf5dc782ce6338c99ca2c969cd2a41f9d3671f58661b1023856dcea441be738e31d39120611935e41967d445c1eb0b6edbdac8e2d992218f8a4d830c13132d38e699f6c8c2530ecd3ecb67db236e48c3fe5eedf09eef6edc0011c21df5d4e5c9a605f9ade8d2a045350c5e766dced30c1fdcf97d37090f4c30481343bb4a16ad1bfb111fc75cf4fec0f1c72118428a41837fbbce5b202983f7db9001c7a1647ed5e6976eedfe6d801dfeaeb4c1f57fa87a5a7a2c785faa29cbbcf6d20d9b0ff6e3c04303ed22c9ed260bd389e8fd50cf804045f0ef2f96ebb800459d00238db3de646fdc4c1cf529de9314b567cda240516132334a5afd01d7ed5461c20483b6063a0676e68d767eff36cb99d06da7698f4e5897ecd178c22970b077ff3e1beee4f3a6bfe85f30f02859e764e01b011fc71455c18164530947d061e67532155308222ed62ce613977abba0264c13f646cd497c5c1a7649f6bb0177197a3a5aa1080fabfc2e1a1d8f6d055bdeae7b82a8b73dc1235989c89c0102f331223a5126bcd2a00f46f965713a28a34d823fdf8f245354d71ba8ae5e7c371b284799163b0eb6d8a8d1798c6e21857db3978a97d1faef606f22c948c20010b96899cfd4420322b832d27f43ff101fb1180fb26acc67588552bfc1305c4836d66a66f91802f00863026563adddcfe94675492967eefd4cc224e5e66bf02b5b5a232567156270ec869ab3bfafbb6c2215e07083a80a3fad2abbbec3d2b88e67ca4debb05d299c2d430e547f8eaef6b94e674833bc36ecc64c0ac8c83b59d12bca52747fd8daf9c7fed823a1f4712be704aae05750806c049380e5623752b5b1fa46aea7585c3841aa02efb234a78ca7c008fd0ef2873c143a6e664b18040888433aafe2c6c8fd6b81f3df020f73c35289178cd08734d2f00e004b0650bb67658784eb8a486c4917bc06d78ccf4848bd1c5e511f763d63294f0a618a6764f2c8bda347f0f5bb8124abdb2bfdc2eb5a8641029ada0153f114e050570a8066b118dfac57fce8757d3d4f110ad1b5bf375a0d231e7bcdb7f1f5c4104c528e74228dd7cc47f704e0a96e6b9c26d4ce74f6cf6a3cb3cf49546e2802556c30570f2391183ad3e653802ec057f0c8e2f5e9ba2be6a3cf49b9176d65239771523d2a460106b08744eb71f3f4a753453ca2470bef58209e090f77d278ca0efbb28f9aa4be2fd101f73dbef25f12a7af296819c7f985be3d04416c833c679fc545ccb70800311e6aee1a19a4b92b85e75b1cdcf136c5b2655df77cd098d84ee65875132bfc6479feb1f7743aa36a1a87a2eeca5c449e4f31471f08ad32116afa6be7abddd0550cea0f1a153d76de58917de89bb1c9d0e13dd94aef2c7dfcddbd251c7968a5c31011c82b043484e5918029b747eb0e64f210f73b69f49d171e540667c5a0e9b0ae664017a7a6a71249db066c5de490a02013e0fe58d828e7d86ee67b76c22da13f65fefa1e64743c93e8835596634eb7cb737d1c8a7f9c052db02f2194c4b843ed60d3b18a48d3dbb1046328d254b542443ef681d42f1225b2fd8e9b070217451fe7ee7d7781d8fd842a525b702b36fe3b8982529aa0fba2865c39f873b97e7481d41da75cf675be1830b14f7b94b7cec029965b360bfd97917a13df0a77910f9f1567b7ffaab2e09873dc27929bbfe7e217c185eb73d7326d7ce81fbabef18ad252cf227e6bb2c1ab36be3954fc98aac004e7fe0e0b4d081d1b7f5cfedbbc7fe4e20a18d3770ccff797f8c02e090859b091d57517b0b1a4d25eaf3255fc931bdd076ab7daf5c9c06c1f862ab79be21f4285e7705202990c8f27f93d08c7f2af2595bfc214f75b32e4601e014fc0cd6dff2e425da535cc3a5f0c4b5117ef18aa7438f9bd429912e94768de574fc545d5f86985c57db610d6c9b13d39a46ded671dcf25da9a92439c4a885200770c49c1e0e5dbe3f3aad30b1261fc5c737c1613bba9579e7be3a561a8250b6700a04d22fa05463405c5f513bafefa0c2ef0c71d96ed14547f30b184e835422f72103385b64ea881c837b5787d376e1c60757ed55da45d12cd39815bbfdbf9ac77ce1c939ecd41d3f4c74131b7cc4bc904a478921cf3e2e36cdd059587ed8bd3cf6837fd5ed20ecf1a6856bb105ec2856beaaa9f11f7fa775f1cedfb79d15f088aa5ae52bb95d299510de6f5bf8ff1e0f15faa56d1e0dae69bdcaf2d730d54756f1564a25c120fc8b53d1a624b22a975ba5ba5919d7cbce0b412fe40ddec25538ea15b8abad1afe4001f46f56b9dcf3ef89467365eafb17ba6da959ce2c8de9cee93e0bd270d71e1dae4807c238a2d8abba8f523ab8c239f860997cfc0bde76cea89ee892864d3857cfcf06ec7fe2e74f8e47d25e6b6a77798bf605a195d7f6dc0c16bba8b21425b6db52465e82fe576f8fff6f6aa967af734d23b3e50cb51032df6f411b3c7b7be75988962685d4a5a9bf5e03a5c0f00911990aa79ed62f85dee4f69f5a20a287d366793f4ad4abc6d9144200fe273e605c2aa3b3a92444894a8d3337fc5105898b317924c2504cbc4599e2fe2b565f6d0d7930472f3327391f35c718587ba616b35571d9df49eab3701c7bc925447d3211ded16fae94155f0cc121b5d8aa4b65dd709788766052332927b8f555dec196279cb03fb1df3710794b5c2aaba836a278131976a99bda49d5df13a6e0898bed47d59062550a23f1babf01e8d6f6fd64d74eb01be3d45173813b359c719b978f0523f2e5cfa0b5bd19bffdc70d2c6e86ac9bfee8057c20cd4ee7d53af3ae666dbbc2a35df983314a0e606dc431ffdff2eb458e1aec4b9cb153865e9687c3419c9ef1d029dca2d5cefe5e320184ac45eb2fb95d6d9c4d6a240d977fea0def9e4a26e16fc2f4c95c753bbbbd6469a4ce1d9f8d4efbf14951377ae9e9cb3e4764b949cb90cef4f23d5692ada1f245b1f486ca8188c73edeec4c552d9230d87c610c43ba7e3ed8daf276677dd3ba719be1dd67f29724e6c8e3c7e98e641de1f944eb554d2800d7bbce8ae3e4e836eaa72abeb674b80d8a350a8aba7a47e09e3a149c8184c6c24abd35d0a15e91a51165e651c077c99e49b260861f0d7a42826b99bc50c16be9fa359e563d5343993533964c075fc1319d3f374594b2474b6642a90f3acfc6ac5aab5058c045a8c3ae8b38cf675439c964c961b64fab5d7c9034cdbcc64d5740f258258989c95de247a4db1b35aaa8e96afe532ed5fdfc5e31d4edf30a2a01815aaf943467c86b84674dc9180ebf49df012ae98d44d69b20651e8a8af62c1ef09e44dc230fa49db3a829133b97370ef68b1e8c01adddd415b85f83dd2d735afe89f0830cf669cbe5282d1727274fcde9b062eeb030fcf8dbec79a15b2f7f82a88ec0a74f1cd910d88fefcd6b20e97b904df424a90992093d99c9f3d713d4ad2faa3efeed0588451598ffe0acc0bbba9b74db5da7b9cadef2d10668c0a7abe2b73d8a8d17712a97f533dd54db7ae2b0e26f366fa81e55f45d2598f79702bb986638ee8ae51153a3b172e65b7171489602b6e3cffac6189ad07e5d21fbca4559d073c81e61c650010c46db9c5a9a0de6da8604ce9ba26cbb017b044b3461acbb1c24c6ce38f1f11b23a498d4522c2c5da186ba93fc022bccd32b79443b487faeb21cf451ecf2b47a1c2a4e865efc507ed64a12e6caf5f6a285c886371aaf8b617cb444c60c2b0408caf0c1677b7a9d2cf0193dca442fd0f01e971c7824ba408356ebca66c42614638194fcaeddb877b30bb9cd72954ccfebfc9be6e6b91f2395e95a999eca7ca31b2845062f4b54d1301bfda17d0eae32b72aa9015a8d61962aed72ddb808888f3855a7ed6629b32c993f505380b2a30974185c0697479fc902b170ea1b24bc87d74d338372be95ce64e1ca4199f5b799cbf9bb5b0653f01264e58471dcb832f99b613ae3ffb11717ccde97f0b85fb80fdd9441ca0c22cf4429e1dd457d03921d16115b770e0171a1e8c9abc15d1899a7de8575a53739ca5c6aa95d0a0c155aa433ccea8ce28a35845fe30065b81721a5c107df08b2d655174c7240e7b7d900fdbd17263018ba43cc2324304544da3bde3b8241226cf85e25dd4b2afb0dc3ff799841086c2de7aeb44ad892720f8fe6b07a208c3f3c1fb5cf0fd741998524c5908bd3ad4f9384bbc77e564e7e2af6be13e8e9daa8e10848be9b252bfeebbc00aed621574054eb6ecc3b3c89e57936f94a243dee35051a54ea8a6527df2c23370d73d180d83b836d18958e35d1e83771cf2b56a344527b9ed48d895dbbbe3b2c13a107ba15c52d4c903a3f2d8925f3799fff50179fca1d142f420c60a6f0a9e14c09987f5192e1107a8b807e6fe3c1a90bb648e204c4c1e19df8f7412f972fe57dfca35d205f21488a8a6e73eaf24721733a538a143910e34f4ed78f4d72105338278a23de728547cce8dbbdcf765f87cf600fb0516010c7bcfbda1010b768e5523f92ce9ddfc6e124ddcee7717fe0a636cd97491d2e2310ffe5f39fed63b6a02c166228a1d34e3dbe4c7782094c1f2fffa2dc9f79004345bdefbfa715260975c1108de509e0816c5784bd15737a71953d3cb367b90b664425759e758ec602f808a592290688cde6dd1a1c01b1429dbd761cb79a20ec4355e4ad8be655452a43b16d8dd1bffa4021eb2f43e336f62804f804511a3749c5a6830da7925825bc1123dee7ea5500ffd06e8508af71b91a6082de71598ca343a48d845ebabbf8eecb01f0212638eb41b2ee5f2225e16c8e92e9fbf6c71c23acffc0f9a534027b95dea19e2043439fec5325e000c26eca0d0676c668b05c56e178da78b2e7603066af740f75f278c5932bf444707ac7c821899328a76643f421cb68a7dcc48e5abe76d11c05e063da9fcaf5be57c0465145b185ec1a8a7d24797a3965a297f774f6edbf2f9c2bf1e2ea1d99bf87dd8b75d71e6be4e6d1aec65ea8f8b26024061644ab2ecf6e8091f14b923b3e3e686d04d1324e87e2294b311e38e1c7106919c0c2c3c433fb737cf57bfc9a58685ea0c76df82e21182f80e1ad0752b8935191fa97672ce80b5a95f7a0f60d55999429aa04aac5ac203438f72c7d513bfb7dc85cf1597e1e28b7a2b281b755043fe5b6677e7088e30a1cf9b213f89d151f405f5f7bff04837314d3a9e702f81836b6469a29bac4450dd857a6b14c5165cb1be7ed6f61363c5408c1885813c05f90761d91883020ed1bbda03f47f7a0104649943a2b33ba58296718eb72c2d01fe9e84ca65e6025617ba42ff5fd4cda4494ac19e7d6d36aa399402aea42f3f8ea8fe0e82bcdaedfd51c566339b6477ae73075f0d8b14ac73bc101a3d0b6f4484e81a8cd3e14043bdeacde4824ad28b6eeadc092679e031744da3405ef5e80f00fe00fd82c12b73b357f5f89a8895d80ef19256b01ba098f65c6c9ad1137719977fceaff5261ceaf87f17a49c03c430d5b5a81196b7053258adc1f050787b0bb955f0c9073a5c33dadc5d61fc7a0bacb6c2a6162220e257ba5e4260d8d78bbcf81c56d7fc368f8eed2f7616f4e617f924ee49613fc495da91c116352d51a119a7a32008e0ef01108a6a6dba9a2e0bd8895d608b69821e5411abd2f7a47fcd378e534c3f38a8f9197d47af9ebe9c19527caed5b84cc5ebccf2a0b2eba20c9beaf47aafd1d522c2d2730d6b243e0cba93087764a0007052b3e50fb2d6a0a3ee5c6aa284be05f1d4880cffe1335755d35eeada49c4c3e35430b7dd1726943571548a6e858c8c0afda73f05e354e6f70d719cad646a6ccad598fc3d1529a0d8f04e5679401634aa8d90abcd5ec6e4514e1d64af0087f1082e73bcb5f8d5374b17459542834c724a4a62c50009f3b46ef1565727b2ce426a89566f2f0838d6dbb9889d522e2396edc4106f26bb6cb84a559b40b7ef7fdc4f3f345d45edd41c50fad9150c303f14006e5e23433dc8d88aee0860bf1b6a129c58bbde1506ee34bbc21774cac5b9274471f5cb26d5880cf3ae492188a5cfdc074cdb0dac3536de693c867262423de4f09af1277120d3506b82413c6e5582c074e61dfe63a125b45dcd45f39e3d071e5b1cd4219b88fdb0c3dcb7206e57a81569c7406229131d1435cc417a2313137959b97ef5c514638d4001f39ce22dfb3358f7ab514587717df1d754cf08628e8a2bd147bbc0a5b2d0334c225b62d091c219e182ef41ee1bc104df7a2561853736af0651686f9d2efa629ac1ea575701e56e0199cdaabd1d8329c6cd83953c3a4589986ce8695f64c7457f8009f19665617b940e5b7c17ec2dd9407aca45312dcde32446e340cd76ff95a9dc14c6b27cf6fa6e971f8426d79022287af1bf6efd318613f873aceab3ecdb4519aa121fc5c6dd976288a23221026661052f2222e066756ec75dce44b1aa371639ee9013e3257566de9ebe483c6c62c25ed1f6609ca64b75ee0214c2d8774d6592af3dadc7e7a279cb5b25019caf0b5f5cd8a52e92e457f39f54acf9fd43369a9f0847799ba4b3821be13b562d23264899e47a2372f7d70ec3086ecfc126c4643c697d1a4c1d422b2eb6dee7865ac07330bb99af85e60fee1557aa8ddf2726e80bfe6074927af2fa6da9df2d09892ba5bc4a1bcff6608ef57131b8f36f72dbec6f57c2013c114f3e3522b8fbd78d99395d1634a108a572fcb1fbc22b38a2b672669fd670c1c1b9c4b16d95ac2f8e5f85d33b79087697cd719996d5379e0f0de6861918f2502d2bff2fcdabf6df8ab02e769645b797da77da8fcda7dff6b0e7b906702c6cf78b4e11d3a458072fc28169dacdb6cb77bc37b13a4e006ecc45527df11b8ddc4d0ebfb3a6d2e2180635a3f0915f4080c2380c1b0f65cee254c63293be0e7b9c4058da120748fedc8e2b49bd8228663ea330275b9b8fdc7e372e74f859743ccfabb4ad372b2d5410b2a801306fd1166e1ec6181c7633c2e46d7ed5d169ab543a44a7a0bfbd70261b6c90e9928c7359067b159164244201a4280c52c99b7d2b301976a4fa0e8b3b070829e1fc05151d7f58c19f2952213c21bcaa44a4a153cf5895098ff09b93d967692ce6cce422d595fa6ce20e764ccf6083374ddae4119ddfe587e39b41cb96cec6eec338107e07caf1a8cd1c7614c81472ac6a5e62204d62f7ea4ca9da261600d5feca8dbd6412b7147d33de275aef193144cb4eb1e974368ac6bd83c680bf834898a0b1d40470170b40f876a4c0d9a9dcec31b844528ede1574ecc6c50940c14b6f27ffe496a56a0613f8f3783ba5a783a4c8db1b1f8f5ad98e7955e5cdecd95d5819e7fba2637ec2b1e694d1f3cfa535d9cf69f1a52362cf856d0bca45e0d7e9a11468b7b7dbc4f3f40eca6c1a52d6f03f1cfe2338aa6e1173d9b79c9a183c675a7d9ecd2272a798da9019cc833fd31fcc8e60a35a38c20a8736ad29a6c7f86e1414b14e5f5c70a6e4c3e92b756f4223229de0ed5f104a58bcf28cff94165799e4e5ffbacc6ee538d02bcaf799dcf3157f916e13e4e03cc69e3b600fe11df2942c11ba125b8e7369626d8441e3896364bd650dca9b057325be054f5a447a7002805f3065cea0126cfdf9a4b8eaf7da481649b7550b3c38fba6e3a1db261c92262a09bcec8bfc0f1e30c0a0ed52ca5e42ebfe7133264c50731e5a213835011faad870606cda5fe7090fa94967c40d4720338c409119b63f1a30125dde18ce8ac9b3da9d14e09914ca2a5f9965922c14e5434850fcb96cec3ad6ef37f800811d83dc621c6b40f8721caf2e3ac044c4ee3d5bef60f29b32a3237d9e02ffe743ccaa78a446c328156ff8975189d9096a863438426f9967c74455559c3f8b4bade5d277275fe6c88b29133cdaa6a6a9c83b81d39da8400e0fce2355046503e15e70e0daa7e29d0fe3472efeae247416e66696c5480468ba23b6110c04767f1fc759fe25592aa0c4f8be0af6df031b2fbd8fa9c55c681d9f49517aea174b823d8518dea21854698c00dc344a0a03f81b7af96776b16bb3dc318e40ace441849299684a06edfa998eae4a0b9a2439291e7f471f847e62734980b0380f3a1c6e655343b3f3c6aa11686a91f531f25efc278fcac446e73434e743e878f2af1ab45826593e1adb06454b656b66c37980d764a38f743a9f7c68b3874b0eeab6ecca7636b440d8ab6834a8d8aa3f09e9624212fb6e8cb4a0737ce976688757f622bdbd3192fa3dd15afbfcaace3a4c0d28e24d235c130d5efb53cb0adf1c6b9d1a3973d1f9b18eb9e157dce54237457c1100f31f2fb1d4b33174edaf9c74d339120fe873a159a634a5b29a8b69c7399060e2372e089c9cd68ea1d327b407de2e9f8376a8a7e9ca6f9fdb3cf5992a9547b2c850e83f16d0e43c1fc7d302a60ef65c92266e1ab9f878936f1801e47428cba3c4b66facd3bd143dfacccd8b6fa24149d6117cf488a4163bb63526d679c81130bc2e9aaf6ce1392cfcae658e1e5a6c08f591c1153ec6b9fda374403b914516016679efcf02404e880a8b1cb89462a9d98c82fe94a84c99ccb1f5540ae53ed240cedb2757d2909af9e9c7b6794c9a5beff40b62c771496ffab3f8482b8ee0147099c4070527b6d2cd1b70e8fb4276533eb902090994fbc8828c565f54cd451baa8ed01b1f4ecb5199504a5eb791660f7122762eff3c21701faf9d5375d6e5cf5d5acb047862f3b471da98a0ab7a9d5e2cac57d0a4e3f7b13f7f524002eef0d1f8ceff0387a1eb1976fe1f11ffeb3db3fc6ea04cf98d6e177a36e5501f5c561b25fc0b9c8b0a70a58281ba75032f90591f277a4f27479a87cb8fe9c250c66c57cc03046c3a5160cd41295f29cc779c05439fbc4e6aff696564938ae1bdf577fe2c582daff46fe7566384c2276696bce849c2b38315804f582cf34e593364b1b14e3850561fc3b14ffa7328b18772e02f3caba107878238b03c44ff4d72367131c0007d8584e9afb6c47840bdafae4c0474121f94e3beea0a7ad7ad48b133db5ed9a7ba8871b670e313f6f6c6fb3ab6492f59d4654acb5a6343396c32a0f5803e17f7e3faf563dac17a1e735235cc23a85b0f849b0e3afea63e9c716aeac0cc5867796744ca9240c1020c29cad4d4a21f58441272aca8ddf9845ef0b8a661dab21e7d9c1009c9cb308f669622b47205696bf9326d793be3adba83e2f65f57de5170591063fd014a54d53d0600f950f515673b289d92f73ec5931316f53b2fc5db8a16968d2bece01e028906f97f5f73b77c69e0d5e61cacf2d0e57482d87c78acced59362b982771409888285e9f7cae1424ca1e149bdaeb14804a720f25848e1e337f7ef77fbbfa7aeeb6de9784fa458ea4d5e8b7649006ee96686cdf0ff916812492b12960b123da39f9430380b466afb6746bf79712a98fe0d641522d2bc8c967a560c46731b3d9f8bed6c59305e423e6609f7343168cdf920facea227371fc48d58241a9a92dbbc6f14998706f0c1cc9fff4a4e2b2213488660c48020f1367676ffde6561ad63a30b7f9eabbd33377182374b3639f3210d566d39e1681c997c0cb4599ca30452f883372867c7baa9cbf4714449c969c2f099d318185861028bc5074022e91ffb4d7bc9ac5f81a0fe078cab0d4e9f69133d8742691512f2c91190faba46248462bcefbf494ef1ae052911db6d27c5a2975a026dda1814cdc9099126502adddf735b1934cee870a20011c1d2172e94a2d36e139e0299ec47d62212d6fe656f00aa4e7bcb6dcfaa70803fae96d3f2afbf695e49be3e0ee5dc861fa495a74327b12d11492b0a840acd1240e401d8abeb354a877de2522887111dfc9b966d5d2c2096e904895c94126dcb2062e03e56283451b4390d442e1b46e27353d487c2628fa46ab88a1612611db50919940782c0ec12c4b51af542fd8c15650b483a304c567474803da63eae95164edfec2af15d7bb9f94df006cc5b98881f46e5390baf727381c0e34d14d8d45c62c800a2964ca412b2f6cec031f95e4b0d548f1b7643a53f75c097df0af43dd4e2312498e8d667b3262d116af2d041e990807a93583c9ac437587cd568c3fed7bb2ba4251c183708818c1dd740ac487d0381630bd0e0dcd690c427f64f023d4479ae2fa13c67f257719788aa6f8bba78afbd67db2fa4f1ce6e78bb52a7dfff59cc3b81683f611459e2ef7ee736e2f751f89dad3cf149ff477d254eea066f40c4c879799f5a7baa23cf84f24571ec8e031ca33428cfeb485343762933d08d038f1241114d1fac4d7c16d04cc383f3258fb9653c8f969f1ead07e7f1e3699f8a37792abc20e2814ec0cfd5dcdfb85b77e53e4583d56fd48da28452b446a932906d7367c7acd5cfa9dd6e8e6e582180538795fd99d8ec3bdc1d89ab2195e327386c5db903fb6ddaa3692d21bbf3162858b2bd55426f847b47d6c3b426e39debd2445b43bc03b41734f399f964add1376bcce8e27270b222accacc9fc5e9ce2dc32e2db48d7fbd900cf191e33d28759883500143d495023a6d6ff055f8ed6bb6eb8de29f3951886c329b1654c53fa999e095800425632e5a80f1c6efd1e0f76fda1a93ae3fa5a434a14c929dfb5f9a2f1211d5f72ae28b9a83021d7eeea8015a9a1ecb0bd7cf089d683719bae2f3d2af1cf5afd7bb3c99df963789f976da54f24350701118f06bebb65b40c4689b3f12cc87342e027f938b602c5e234d747946894704eac203975100c631716c253acc2d6debe8068c6e522a784bd128bcf47e0e6383f19d4c9ed9f5b98e71d5565bf30058f821760b70e38e1fb0765df0c41d967c1f9aa36616d1110de61481a71ac2a725e16ef5599bf3d7c89554e31ed1b067b7b336a4075d1a42fdca3c90416b4c977a0e769f779d9a954a2fcbd086671bcd3475eccbcfa13a97c3893b28ae901ccd240797f68ce13d20f2d2a903190bf4587465c911030ac0a4097f444607318fdc868101ff2c15b03bb7c19c45093f1ef8a9fc008eaf1654ca18833d61d9869c020a1f866a809f7d855662dcd0445017361fb7807f541ec118ad602e186bac406de8046664a51bfdcad45a3e241af1e3c4a50d6ba661a3996550e7f136815a90abfb22723d47df94e1130d372836eba116680ae49907751569f4f5c1c5af7a9e479b66d87446afccada16fa306c905e696cabfff643fc3622939809a3e34239c9a4980cb3818f7377b5d8f3e6637e916a96ac7d705a4bb4801c16eb01e83f27c001b27ffa7f845a5abe54b02e7724f7780e738bceb6f815b0312a90c3805801058df8f0ead83ff6a32859f5a2d4d9e7b0f6cb098ba363ac49602d684d819da5970a8370d69ce10f69bf1674ff07e1598772f7336295b150dbb0c21b36058aa775067da8f92bf3ee8b3b2863defd73c3e95ffa6fee1e065a")
	assert.NoError(t, err)

	var standardTx transactions.StandardTransaction
	err = proto.Unmarshal(stdTxBytes, &standardTx)
	assert.NoError(t, err)

	err = proofValidator.Validate([]*transactions.Transaction{
		transactions.WrapTransaction(&standardTx),
		//transactions.WrapTransaction(stakeTx),
		//transactions.WrapTransaction(mintTx),
		//transactions.WrapTransaction(treasuryTx),
		//transactions.WrapTransaction(coinbaseTx),
	})
	assert.NoError(t, err)

	/*c := ValidateTransactionProof(transactions.WrapTransaction(coinbaseTx), NewProofCache(10))
	err = <-c
	assert.NoError(t, err)*/
}
